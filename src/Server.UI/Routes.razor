@inject LayoutService LayoutService
@using CleanArchitecture.Blazor.Server.UI.Components.Shared

<CascadingAuthenticationState>
    <Router AppAssembly="@typeof(Program).Assembly">
        <Found Context="routeData">
            <AuthorizeRouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)">
                <Authorizing>
                    <div style="display: flex; justify-content: center; align-items: center; min-height: 60vh;">
                        <MudPaper Class="pa-8" Elevation="1" Style="max-width: 400px; text-align: center;">
                            <MudProgressCircular Indeterminate="true" Color="Color.Primary" Size="Size.Medium" Class="mb-4" />
                            <MudText Typo="Typo.h6" Color="Color.Default">"Please wait, we are authorizing you..."</MudText>
                        </MudPaper>
                    </div>
                </Authorizing>
                <NotAuthorized>
                    <ErrorPageComponent Type="ErrorPageComponent.ErrorType.AccessDenied" 
                                       ShowContactButton="true" />
                </NotAuthorized>
            </AuthorizeRouteView>
            <FocusOnNavigate RouteData="@routeData" Selector="h1"/>
        </Found>
        <NotFound>
            <PageTitle>Not found</PageTitle>
            <LayoutView Layout="@typeof(MainLayout)">
                <div style="display: flex; justify-content: center; align-items: center; min-height: 60vh;">
                    <MudPaper Class="pa-8" Elevation="1" Style="max-width: 600px; text-align: center;">
                        <MudIcon Icon="@Icons.Material.Filled.Error" Style="font-size: 4rem; color: #f44336;" Class="mb-4" />
                        <MudText Typo="Typo.h4" Color="Color.Error" Class="mb-4">Page Not Found</MudText>
                        <MudText Typo="Typo.body1" Class="mb-4">
                            The page you are looking for could not be found or there was an error loading it.
                        </MudText>
                        <MudText Typo="Typo.body2" Color="Color.Secondary" Class="mb-4">
                            URL: @NavigationManager.Uri
                        </MudText>
                        <MudDivider Class="my-4" />
                        <MudButton Variant="Variant.Filled" 
                                  Color="Color.Primary" 
                                  StartIcon="@Icons.Material.Filled.Home"
                                  Href="/"
                                  Class="mr-2">
                            Go Home
                        </MudButton>
                        <MudButton Variant="Variant.Outlined" 
                                  Color="Color.Secondary" 
                                  StartIcon="@Icons.Material.Filled.Refresh"
                                  OnClick="@(() => NavigationManager.Refresh(true))">
                            Refresh Page
                        </MudButton>
                    </MudPaper>
                </div>
            </LayoutView>
        </NotFound>
    </Router>
</CascadingAuthenticationState>

@inject NavigationManager NavigationManager

